//%attributes = {}

// ----------------------------------------------------
// User name (OS): amercer
// Date and time: 09/17/19, 12:42:53
// ----------------------------------------------------
// Method: MergeObjects
// Description
// 
//
// Parameters
// ----------------------------------------------------

// ******************************************************************************************** //
// ** TYPE AND INITIALIZE PARAMETERS ********************************************************** //
// ******************************************************************************************** //

C_OBJECT:C1216($0; $voMerged)

C_OBJECT:C1216($1; $voBase)
$voBase:=$1

C_OBJECT:C1216($2; $voMergeDown)
$voMergeDown:=$2

// ******************************************************************************************** //
// ** TYPE AND INITIALIZE LOCAL VARIABLES ***************************************************** //
// ******************************************************************************************** //

C_LONGINT:C283($viCounterKeys)
ARRAY TEXT:C222($atKeys; 0)
OB GET PROPERTY NAMES:C1232($voMergeDown; $atKeys)
C_TEXT:C284($vtKey)

// ******************************************************************************************** //
// ** LOOP THROUGH KEYS AND MERGE EACH ONE DOWN INTO BASE, OVERWRITING IF DUPLICATE *********** //
// ******************************************************************************************** //

$voMerged:=OB Copy:C1225($voBase)

For ($viCounterKeys; 1; Size of array:C274($atKeys))
	
	$vtKey:=$atKeys{$viCounterKeys}
	
	OB_CopyField(->$voMergeDown; $vtKey; ->$voMerged; $vtKey)
	
End for 

// ******************************************************************************************** //
// ** RETURN THE MERGED OBJECT **************************************************************** //
// ******************************************************************************************** //

$0:=$voMerged