//%attributes = {"publishedWeb":true}
C_LONGINT:C283($1; $2; $3)
Case of 
	: ($1=0)
		ARRAY LONGINT:C221(aStkDocID; 0)  // PO
		ARRAY LONGINT:C221(aStkPoLnNum; 0)  // for InvStack
		ARRAY REAL:C219(aStkOrCost; 0)
		ARRAY REAL:C219(aStkOrQty; 0)
		ARRAY REAL:C219(aStkDuty; 0)
		ARRAY REAL:C219(aStkNonPd; 0)
		ARRAY REAL:C219(aStkVAT; 0)
		ARRAY LONGINT:C221(aStkRec; 0)
		ARRAY BOOLEAN:C223(aStkJrl; 0)
		ARRAY TEXT:C222(aStkItem; 0)
		ARRAY TEXT:C222(aStkType; 0)
		ARRAY TEXT:C222(aStkWayBill; 0)
		//
		ARRAY REAL:C219(aStkNwCost; 0)
		ARRAY REAL:C219(aStkWt; 0)
		ARRAY LONGINT:C221(aStkPoLnRec; 0)
		ARRAY LONGINT:C221(aStkReceiptID; 0)
		//
		ARRAY LONGINT:C221(aStkSelect; 0)
	: ($1>0)
		C_LONGINT:C283($i; $k)
		SELECTION TO ARRAY:C260([InventoryStack:29]; aStkRec; [InventoryStack:29]docid:5; aStkDocID; [InventoryStack:29]receiptid:16; aStkReceiptID; [InventoryStack:29]unitCost:11; aStkOrCost; [InventoryStack:29]qtyOnHand:9; aStkOrQty; [InventoryStack:29]itemNum:2; aStkItem; [InventoryStack:29]typeid:19; aStkType)
		SELECTION TO ARRAY:C260([InventoryStack:29]lineNum:12; aStkPoLnNum; [InventoryStack:29]duties:21; aStkDuty; [InventoryStack:29]nonProcCosts:22; aStkNonPd; [InventoryStack:29]jrnlComplete:13; aStkJrl; [InventoryStack:29]wayBillNum:24; aStkWayBill; [InventoryStack:29]vaTax:23; aStkVAT)
		ARRAY REAL:C219(aStkNwCost; $1)
		ARRAY REAL:C219(aStkWt; $1)
		ARRAY LONGINT:C221(aStkPoLnRec; $1)
		For ($i; 1; $1)
			QUERY:C277([POLine:40]; [POLine:40]poNum:1=aStkDocID{$i}; *)
			QUERY:C277([POLine:40];  & [POLine:40]lineNum:14=aStkPoLnNum{$i})
			aStkPoLnRec{$i}:=Record number:C243([POLine:40])
			aStkNwCost{$i}:=aStkOrCost{$i}
			aStkWt{$i}:=[POLine:40]unitWt:29
		End for 
	: ($1=-1)
		DELETE FROM ARRAY:C228(aStkDocID; $2; $3)
		DELETE FROM ARRAY:C228(aStkPoLnNum; $2; $3)
		DELETE FROM ARRAY:C228(aStkOrCost; $2; $3)
		DELETE FROM ARRAY:C228(aStkNwCost; $2; $3)
		DELETE FROM ARRAY:C228(aStkOrQty; $2; $3)
		DELETE FROM ARRAY:C228(aStkWt; $2; $3)
		DELETE FROM ARRAY:C228(aStkDuty; $2; $3)
		DELETE FROM ARRAY:C228(aStkVAT; $2; $3)
		DELETE FROM ARRAY:C228(aStkNonPd; $2; $3)
		DELETE FROM ARRAY:C228(aStkRec; $2; $3)
		DELETE FROM ARRAY:C228(aStkPoLnNum; $2; $3)
		DELETE FROM ARRAY:C228(aStkJrl; $2; $3)
		DELETE FROM ARRAY:C228(aStkItem; $2; $3)
		DELETE FROM ARRAY:C228(aStkType; $2; $3)
		DELETE FROM ARRAY:C228(aStkWayBill; $2; $3)
		DELETE FROM ARRAY:C228(aStkReceiptID; $2; $3)
		//
		ARRAY LONGINT:C221(aStkSelect; 0)
	: ($1=-3)
		INSERT IN ARRAY:C227(aStkDocID; $2; $3)
		INSERT IN ARRAY:C227(aStkPoLnNum; $2; $3)
		INSERT IN ARRAY:C227(aStkOrCost; $2; $3)
		INSERT IN ARRAY:C227(aStkNwCost; $2; $3)
		INSERT IN ARRAY:C227(aStkOrQty; $2; $3)
		INSERT IN ARRAY:C227(aStkWt; $2; $3)
		INSERT IN ARRAY:C227(aStkDuty; $2; $3)
		INSERT IN ARRAY:C227(aStkVAT; $2; $3)
		INSERT IN ARRAY:C227(aStkNonPd; $2; $3)
		INSERT IN ARRAY:C227(aStkRec; $2; $3)
		INSERT IN ARRAY:C227(aStkPoLnNum; $2; $3)
		INSERT IN ARRAY:C227(aStkJrl; $2; $3)
		INSERT IN ARRAY:C227(aStkItem; $2; $3)
		INSERT IN ARRAY:C227(aStkType; $2; $3)
		INSERT IN ARRAY:C227(aStkWayBill; $2; $3)
		INSERT IN ARRAY:C227(aStkReceiptID; $2; $3)
		//
		ARRAY LONGINT:C221(aStkSelect; 0)
End case 